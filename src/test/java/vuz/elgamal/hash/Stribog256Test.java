package vuz.elgamal.hash;

import org.junit.Test;

import java.util.Arrays;

import static org.junit.Assert.assertEquals;

public class Stribog256Test {

    @Test
    public void getHashTest() {
        byte[] data = new byte[]{
            0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,
            0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,
            0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,
            0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30
        };
        byte[] expected = new byte[]{
            0x00,0x55,0x7b, (byte) 0xe5, (byte) 0xe5, (byte) 0x84, (byte) 0xfd,0x52, (byte) 0xa4,0x49, (byte) 0xb1,0x6b,0x02,0x51, (byte) 0xd0,0x5d,
            0x27, (byte) 0xf9,0x4a, (byte) 0xb7,0x6C, (byte) 0xba, (byte) 0xa6, (byte) 0xda, (byte) 0x89,0x0b,0x59, (byte) 0xd8, (byte) 0xef,0x1e,0x15, (byte) 0x9d
        };

        Stribog256 stribog = new Stribog256();
        stribog.fillBuffer(data);

        byte[] hash = stribog.getHash();
        assertEquals(Boolean.TRUE, Arrays.equals(expected, hash));
    }
}